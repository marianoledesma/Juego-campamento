<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campamento - Juego de predicciones</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Titan+One&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.2/anime.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
  <style>
    :root {
      /* SUMMER POP PALETTE üåä‚òÄÔ∏è */
      --color-ocean-start: #4facfe;
      --color-ocean-end: #00f2fe;
      --color-sunset: #FF7E5F;
      --color-corn: #FFD700;
      --color-coral: #FF6B6B;
      --color-navy: #0F172A;
      --color-white: #FFFFFF;
      --color-sand: #FFE5B4;
      
      /* Sombras con efecto 3D/Flat */
      --shadow-flat: 6px 6px 0px rgba(0, 0, 0, 0.2);
      --shadow-flat-hover: 8px 8px 0px rgba(0, 0, 0, 0.25);
      --shadow-winner: 8px 8px 0px rgba(255, 215, 0, 0.6);
      
      /* Border radius */
      --radius-card: 20px;
      --radius-button: 16px;
      --radius-full: 9999px;
    }
    * { box-sizing: border-box; }
    
    /* Imagen de fondo de la playa */
    #video-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      z-index: -2;
      background-image: url('assets/Screenshot_2026-02-06_at_21.14.47-68ef46a2-9ddf-46c8-b9fc-7f5421bff88c.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      font-family: 'Roboto', -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--color-navy);
      padding: 0;
      position: relative;
      overflow-x: hidden;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, 
        var(--color-ocean-start) 0%, 
        var(--color-ocean-end) 100%);
      pointer-events: none;
      z-index: -1;
    }
    .contenedor {
      max-width: 1400px;
      margin: 0 auto;
      position: relative;
      z-index: 10;
      padding: 80px 1.5rem 2rem;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    /* NAVEGACI√ìN SUPERIOR DISCRETA */
    .nav-superior {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      padding: 0.75rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }
    
    .nav-arrow {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: var(--color-white);
      border: 3px solid var(--color-navy);
      color: var(--color-navy);
      font-size: 1.5rem;
      font-weight: bold;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      box-shadow: 3px 3px 0px rgba(0, 0, 0, 0.15);
    }
    .nav-arrow:hover {
      transform: scale(1.1);
      box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.2);
    }
    .nav-arrow:active {
      transform: scale(0.95);
      box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.15);
    }
    .nav-arrow:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      transform: scale(1);
    }
    
    /* BOT√ìN FLOTANTE DE AYUDA (FAB) */
    .btn-flotante-ayuda {
      position: fixed;
      bottom: 1.5rem;
      right: 1.5rem;
      z-index: 1000;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: var(--color-sand);
      border: 3px solid var(--color-navy);
      color: var(--color-navy);
      font-size: 1.75rem;
      font-weight: 500;
      cursor: pointer;
      box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.2);
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: inherit;
    }
    .btn-flotante-ayuda:hover {
      transform: scale(1.1);
      box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.25);
    }
    .btn-flotante-ayuda:active {
      transform: scale(0.95);
      box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.2);
    }
    
    /* MODAL */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      backdrop-filter: blur(8px);
    }
    .modal-contenido {
      background: var(--color-white);
      border: 4px solid var(--color-navy);
      border-radius: var(--radius-card);
      padding: 2rem;
      max-width: 500px;
      width: 100%;
      box-shadow: var(--shadow-flat);
      color: var(--color-navy);
      animation: modal-pop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    @keyframes modal-pop {
      0% { transform: scale(0.7); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .modal-contenido h3 {
      margin-top: 0;
      margin-bottom: 1rem;
      font-family: 'Fredoka One', cursive;
      font-size: 1.75rem;
      font-weight: 400;
      color: var(--color-navy);
    }
    .modal-contenido p {
      margin-bottom: 1.5rem;
      color: var(--color-navy);
      font-size: 1rem;
      opacity: 0.8;
    }
    .modal-contenido input[type="file"] {
      width: 100%;
      padding: 1rem;
      margin-bottom: 1.5rem;
      background: var(--color-white);
      color: var(--color-navy);
      border: 3px solid var(--color-navy);
      border-radius: 12px;
      font-family: inherit;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .modal-contenido input[type="file"]:hover {
      background: var(--color-sand);
      transform: translateY(-2px);
    }
    .archivo-ok {
      padding: 1rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, #A7F3D0 0%, #6EE7B7 100%);
      color: var(--color-navy);
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      box-shadow: 3px 3px 0px rgba(0, 0, 0, 0.15);
    }
    
    /* HERO SECTION - PREGUNTA PRINCIPAL */
    .area-pregunta-grande {
      background: var(--color-white);
      border: none;
      border-radius: var(--radius-card);
      padding: 3rem 2rem;
      margin: 0 auto 2.5rem;
      text-align: center;
      box-shadow: var(--shadow-flat);
      position: relative;
      min-height: 280px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      transition: all 0.3s ease;
    }
    .area-pregunta-grande:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-flat-hover);
    }
    .area-pregunta-grande h2 {
      font-family: 'Fredoka One', 'Titan One', cursive;
      font-size: clamp(2rem, 6vw, 4.5rem);
      line-height: 1.2;
      margin: 0;
      color: var(--color-navy);
      font-weight: 400;
      letter-spacing: -0.01em;
      text-shadow: 3px 3px 0px rgba(255, 215, 0, 0.3);
      animation: bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      transition: font-size 0.3s ease;
    }
    
    /* Tipograf√≠a Adaptable seg√∫n longitud */
    .area-pregunta-grande h2.text-corto {
      font-size: clamp(2.5rem, 7vw, 5.5rem);
    }
    
    .area-pregunta-grande h2.text-medio {
      font-size: clamp(2rem, 6vw, 4.5rem);
    }
    
    .area-pregunta-grande h2.text-largo {
      font-size: clamp(1.5rem, 4.5vw, 3.5rem);
    }
    
    .area-pregunta-grande h2.text-muy-largo {
      font-size: clamp(1.25rem, 3.5vw, 2.75rem);
    }
    
    /* Emoji destacado en el t√≠tulo */
    .area-pregunta-grande h2 .emoji-icon {
      display: inline-block;
      font-size: 1.2em;
      margin-right: 0.25em;
      animation: emoji-bounce 1s ease-in-out infinite;
    }
    
    @keyframes emoji-bounce {
      0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
      50% { transform: translateY(-8px) rotate(5deg) scale(1.1); }
    }
    
    /* Mejora visual para el emoji en responsive */
    @media (max-width: 768px) {
      .area-pregunta-grande h2 .emoji-icon {
        font-size: 1.15em;
        margin-right: 0.2em;
      }
    }
    
    @keyframes bounce-in {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .contador-pregunta {
      font-family: 'Fredoka One', cursive;
      font-size: 1.25rem;
      font-weight: 400;
      color: var(--color-navy);
      padding: 0.5rem 1.5rem;
      background: var(--color-corn);
      border-radius: var(--radius-full);
      letter-spacing: 0.02em;
      box-shadow: 3px 3px 0px rgba(0, 0, 0, 0.2);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      white-space: nowrap;
    }
    /* √ÅREA DE PREDICCIONES */
    .area-predicciones {
      background: rgba(255, 255, 255, 0.95);
      border: none;
      border-radius: var(--radius-card);
      padding: 2rem;
      margin-bottom: 2.5rem;
      box-shadow: var(--shadow-flat);
      transition: all 0.3s ease;
      backdrop-filter: blur(12px);
    }
    .area-predicciones h3 {
      margin: 0 0 2rem 0;
      font-family: 'Fredoka One', cursive;
      font-size: 1.75rem;
      font-weight: 400;
      text-align: center;
      color: var(--color-navy);
      letter-spacing: 0.02em;
    }
    
    /* BOT√ìN REVELAR - PROTAGONISTA ABSOLUTO */
    .btn-revelar-container {
      text-align: center;
      margin: 3rem auto;
      padding: 0 1rem;
    }
    
    .btn-flotante-revelar {
      padding: 1.75rem 4rem;
      font-family: 'Fredoka One', cursive;
      font-size: 2rem;
      font-weight: 400;
      letter-spacing: 0.1em;
      color: var(--color-white);
      border: none;
      border-radius: var(--radius-button);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      background: linear-gradient(135deg, var(--color-sunset) 0%, var(--color-coral) 100%);
      box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3);
      transition: all 0.2s ease;
      white-space: nowrap;
      position: relative;
      text-transform: uppercase;
      animation: pulse-glow 2s infinite;
    }
    
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3), 0 0 30px rgba(255, 126, 95, 0.4); }
      50% { box-shadow: 0 8px 0 rgba(0, 0, 0, 0.3), 0 0 50px rgba(255, 126, 95, 0.8); }
    }
    
    .btn-flotante-revelar:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 0 rgba(0, 0, 0, 0.3), 0 0 60px rgba(255, 126, 95, 1);
    }
    .btn-flotante-revelar:active {
      transform: translateY(4px);
      box-shadow: 0 4px 0 rgba(0, 0, 0, 0.3);
    }
    .btn-flotante-revelar .cta-icon {
      font-size: 1.5em;
      line-height: 1;
      animation: rotate-star 3s linear infinite;
    }
    
    @keyframes rotate-star {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    
    .btn-flotante-revelar .cta-text {
      font-weight: 400;
      letter-spacing: 0.1em;
    }
    .equipos-config {
      margin: 0;
    }
    .equipos-inputs {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 1.5rem;
    }
    
    /* GAMIFICACI√ìN: Fichas de Juego */
    .input-fila-item {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      background: var(--color-white);
      padding: 1.25rem;
      border-radius: var(--radius-card);
      border: 4px solid var(--color-navy);
      transition: all 0.3s ease;
      position: relative;
      box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.15);
    }
    .input-fila-item:hover {
      transform: translateY(-2px);
      box-shadow: 6px 6px 0px rgba(0, 0, 0, 0.2);
    }
    
    /* Estado "Listo" - cuando hay valor */
    .input-fila-item.listo {
      border-color: var(--color-sunset);
      background: linear-gradient(135deg, #fff 0%, #fff8f0 100%);
    }
    .input-fila-item.listo::after {
      content: '‚úì';
      position: absolute;
      top: -8px;
      right: -8px;
      width: 28px;
      height: 28px;
      background: var(--color-sunset);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1rem;
      box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.2);
    }
    
    /* Estado "Ganador" */
    .input-fila-item.ganador {
      border-color: var(--color-corn) !important;
      background: linear-gradient(135deg, #FFD700 0%, #FFF9C4 100%) !important;
      transform: scale(1.1) !important;
      box-shadow: var(--shadow-winner) !important;
      animation: winner-pulse 0.6s ease-out;
      z-index: 10;
    }
    .input-fila-item.ganador::before {
      content: 'üèÜ';
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2.5rem;
      animation: trophy-bounce 0.8s ease-out;
    }
    
    @keyframes winner-pulse {
      0%, 100% { transform: scale(1.1); }
      50% { transform: scale(1.15); }
    }
    
    @keyframes trophy-bounce {
      0% { transform: translateX(-50%) translateY(-30px) scale(0); }
      60% { transform: translateX(-50%) translateY(5px) scale(1.2); }
      100% { transform: translateX(-50%) translateY(0) scale(1); }
    }
    
    /* Estado "Perdedor" */
    .input-fila-item.perdedor {
      opacity: 0.5;
      filter: grayscale(0.3);
    }
    
    .input-fila-item label {
      font-family: 'Fredoka One', cursive;
      font-size: 1.1rem;
      font-weight: 400;
      text-align: center;
      color: var(--color-navy);
      letter-spacing: 0.05em;
    }
    
    /* Contenedor del input con prefijo/sufijo */
    .input-wrapper {
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
    }
    
    .input-prefix,
    .input-suffix {
      position: absolute;
      font-family: 'Roboto', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--color-navy);
      opacity: 0.6;
      pointer-events: none;
      z-index: 1;
    }
    
    .input-prefix {
      left: 1rem;
    }
    
    .input-suffix {
      right: 1rem;
      font-size: 1.25rem;
      opacity: 0.5;
    }
    
    .input-pred {
      padding: 1rem;
      font-size: 1.75rem;
      font-family: 'Roboto', sans-serif;
      border-radius: 12px;
      border: 3px solid var(--color-navy);
      background: var(--color-white);
      color: var(--color-navy);
      font-weight: 700;
      text-align: center;
      transition: all 0.2s ease;
      width: 100%;
    }
    
    /* Ajustar padding cuando hay prefijo/sufijo */
    .input-pred.has-prefix {
      padding-left: 2.5rem;
    }
    
    .input-pred.has-suffix {
      padding-right: 3rem;
    }
    
    .input-pred:focus {
      outline: none;
      border-color: var(--color-sunset);
      box-shadow: 0 0 0 4px rgba(255, 126, 95, 0.2);
      transform: scale(1.05);
    }
    .input-pred::placeholder {
      color: rgba(15, 23, 42, 0.3);
    }
    
    /* Input tipo hora */
    .input-pred[type="time"] {
      font-family: 'Roboto Mono', monospace;
      letter-spacing: 0.1em;
    }
    /* RESULTADO REVELADO - DRAM√ÅTICO */
    .resultado-revelado {
      background: var(--color-white);
      border: 6px solid var(--color-corn);
      border-radius: var(--radius-card);
      padding: 3rem 2rem;
      margin: 2rem 0;
      text-align: center;
      box-shadow: var(--shadow-winner);
      animation: resultadoEntra 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
    }
    
    .resultado-revelado::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.3), transparent);
      animation: shine 2s infinite;
    }
    
    @keyframes shine {
      0% { left: -100%; }
      100% { left: 200%; }
    }
    
    @keyframes resultadoEntra {
      from { opacity: 0; transform: scale(0.5) rotate(-5deg); }
      60% { transform: scale(1.1) rotate(2deg); }
      to { opacity: 1; transform: scale(1) rotate(0deg); }
    }
    
    .resultado-revelado .respuesta-correcta {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(2rem, 5vw, 4rem);
      font-weight: 400;
      margin-bottom: 1.5rem;
      color: var(--color-navy);
      letter-spacing: 0.02em;
      animation: number-pop 0.8s ease-out;
      position: relative;
      z-index: 1;
    }
    
    @keyframes number-pop {
      0% { transform: scale(0); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }
    
    .resultado-revelado .ganador-texto {
      font-family: 'Fredoka One', cursive;
      font-size: clamp(1.5rem, 4vw, 3rem);
      font-weight: 400;
      color: var(--color-sunset);
      letter-spacing: 0.05em;
      animation: winner-appear 1s ease-out 0.5s both;
      position: relative;
      z-index: 1;
    }
    
    @keyframes winner-appear {
      0% { opacity: 0; transform: translateY(20px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    .btn {
      padding: 0.875rem 2rem;
      font-size: 1rem;
      font-family: 'Roboto', sans-serif;
      font-weight: 600;
      border: none;
      border-radius: var(--radius-button);
      cursor: pointer;
      transition: all 0.2s ease;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }
    .btn:hover { 
      transform: translateY(-2px);
    }
    .btn:active { 
      transform: scale(0.95);
    }
    .btn-primario {
      background: var(--color-navy);
      color: var(--color-white);
      box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.3);
    }
    .btn-primario:hover { 
      box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.35);
    }
    .btn-primario:active {
      box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.3);
    }
    .btn-secundario {
      background: var(--color-sunset);
      color: var(--color-white);
      box-shadow: 4px 4px 0px rgba(0, 0, 0, 0.3);
    }
    .btn-secundario:hover { 
      box-shadow: 5px 5px 0px rgba(0, 0, 0, 0.35);
    }
    .btn-secundario:active {
      box-shadow: 2px 2px 0px rgba(0, 0, 0, 0.3);
    }
    .btn-chico {
      padding: 0.625rem 1.25rem;
      font-size: 0.875rem;
    }
    .oculto { display: none !important; }
    /* Toast / Snackbar Playero */
    .toast-playero {
      position: fixed;
      top: 90px;
      left: 50%;
      transform: translateX(-50%) translateY(-100px);
      z-index: 10000;
      padding: 1rem 2rem;
      border-radius: var(--radius-button);
      font-family: 'Fredoka One', cursive;
      font-size: 1.25rem;
      font-weight: 400;
      color: var(--color-white);
      text-align: center;
      white-space: nowrap;
      max-width: 90vw;
      overflow: hidden;
      text-overflow: ellipsis;
      pointer-events: none;
      opacity: 0;
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      background: linear-gradient(135deg, var(--color-corn) 0%, var(--color-sunset) 100%);
      box-shadow: 0 6px 0 rgba(0, 0, 0, 0.3);
    }
    .toast-playero.toast-visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
    .toast-playero.toast-sale {
      transform: translateX(-50%) translateY(-120px) scale(0.8);
      opacity: 0;
    }
    .toast-playero .toast-icon {
      margin-right: 0.5rem;
      font-size: 1.25em;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      .contenedor {
        padding: 70px 1rem 2rem;
      }
      .nav-superior {
        padding: 0.5rem 1rem;
      }
      .nav-arrow {
        width: 40px;
        height: 40px;
        font-size: 1.25rem;
      }
      .contador-pregunta {
        font-size: 1rem;
        padding: 0.5rem 1rem;
      }
      .btn-flotante-ayuda {
        bottom: 1rem;
        right: 1rem;
        width: 48px;
        height: 48px;
        font-size: 1.5rem;
      }
      .area-pregunta-grande {
        padding: 2rem 1.25rem;
        min-height: 220px;
      }
      .area-pregunta-grande h2 {
        font-size: clamp(1.75rem, 5vw, 3rem);
      }
      .area-predicciones {
        padding: 1.5rem;
      }
      .area-predicciones h3 {
        font-size: 1.5rem;
      }
      .equipos-inputs {
        grid-template-columns: 1fr;
        gap: 1.25rem;
      }
      .input-fila-item {
        padding: 1rem;
      }
      .input-pred {
        font-size: 1.5rem;
        padding: 0.875rem;
      }
      .input-prefix,
      .input-suffix {
        font-size: 1.25rem;
      }
      .input-prefix {
        left: 0.75rem;
      }
      .input-suffix {
        right: 0.75rem;
      }
      .input-pred.has-prefix {
        padding-left: 2rem;
      }
      .input-pred.has-suffix {
        padding-right: 2.5rem;
      }
      .btn-flotante-revelar {
        padding: 1.25rem 2.5rem;
        font-size: 1.5rem;
      }
      .btn-flotante-revelar .cta-icon {
        font-size: 1.25em;
      }
      .btn-revelar-container {
        margin: 2rem auto;
      }
      .resultado-revelado {
        padding: 2rem 1.5rem;
      }
      .resultado-revelado .respuesta-correcta {
        font-size: clamp(1.75rem, 4vw, 3rem);
      }
      .resultado-revelado .ganador-texto {
        font-size: clamp(1.25rem, 3.5vw, 2.5rem);
      }
    }
  </style>
</head>
<body>
  <!-- Imagen de fondo de la playa -->
  <div id="video-background"></div>
  
  <div id="toast-playero" class="toast-playero oculto" role="status" aria-live="polite"></div>
  
  <!-- BOT√ìN FLOTANTE üèùÔ∏è PARA CARGAR RESPUESTAS -->
  <button type="button" class="btn-flotante-ayuda animate__animated animate__fadeInDown" id="btn-flotante-ayuda" aria-label="Cargar respuestas desde JSON">
    üèùÔ∏è
  </button>

  <!-- Modal para cargar respuestas -->
  <div class="modal-overlay oculto" id="modal-respuestas">
    <div class="modal-contenido animate__animated animate__zoomIn">
      <h3>üèñÔ∏è Cargar respuestas</h3>
      <p>Selecciona el archivo JSON con las respuestas correctas:</p>
      <input type="file" id="input-archivo-respuestas" accept=".json" />
      <div class="archivo-ok oculto" id="archivo-ok" aria-live="polite"></div>
      <button type="button" class="btn btn-secundario" id="btn-cerrar-modal">Cerrar</button>
    </div>
  </div>

  <!-- NAVEGACI√ìN SUPERIOR DISCRETA -->
  <nav class="nav-superior">
    <button type="button" class="nav-arrow" id="btn-pregunta-anterior" aria-label="Pregunta anterior">‚Äπ</button>
    <span class="contador-pregunta" id="contador-pregunta">üèÑ Pregunta 1</span>
    <button type="button" class="nav-arrow" id="btn-pregunta-siguiente" aria-label="Pregunta siguiente">‚Ä∫</button>
  </nav>

  <div class="contenedor">
    <!-- HERO SECTION - PREGUNTA PRINCIPAL -->
    <div class="area-pregunta-grande animate__animated animate__fadeInUp">
      <h2 id="texto-pregunta">üåä ¬øCu√°nto sale un choclo de la playa?</h2>
    </div>

    <!-- √ÅREA DE PREDICCIONES (donde los equipos ingresan) -->
    <div class="area-predicciones animate__animated animate__fadeIn">
      <h3>üèñÔ∏è Los equipos ingresan sus predicciones</h3>
      <div class="equipos-config">
        <div class="equipos-inputs" id="equipos-inputs-container">
          <div class="input-fila-item">
            <label id="label-equipo-0">Equipo 1</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="0" placeholder="500" inputmode="numeric" />
            </div>
          </div>
          <div class="input-fila-item">
            <label id="label-equipo-1">Equipo 2</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="1" placeholder="500" inputmode="numeric" />
            </div>
          </div>
          <div class="input-fila-item">
            <label id="label-equipo-2">Equipo 3</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="2" placeholder="500" inputmode="numeric" />
            </div>
          </div>
          <div class="input-fila-item">
            <label id="label-equipo-3">Equipo 4</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="3" placeholder="500" inputmode="numeric" />
            </div>
          </div>
          <div class="input-fila-item">
            <label id="label-equipo-4">Equipo 5</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="4" placeholder="500" inputmode="numeric" />
            </div>
          </div>
          <div class="input-fila-item">
            <label id="label-equipo-5">Equipo 6</label>
            <div class="input-wrapper">
              <input type="text" class="input-pred" data-equipo="5" placeholder="500" inputmode="numeric" />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- BOT√ìN REVELAR -->
    <div class="btn-revelar-container">
      <button type="button" class="btn-flotante-revelar animate__animated animate__pulse animate__infinite" id="btn-revelar-cta" aria-label="Revelar respuesta y ver ganador">
        <span class="cta-icon" aria-hidden="true">üåü</span>
        <span class="cta-text">REVELAR</span>
      </button>
    </div>

    <!-- RESULTADO REVELADO -->
    <div id="resultado" class="resultado-revelado oculto"></div>
  </div>

  <script>
    const PREGUNTAS = [
      // --- Las 7 Originales ---
      { texto: 'üåΩ ¬øCu√°nto sale un choclo de la playa?', tipo: 'numero', placeholder: 'Ej: 500' },
      { texto: 'üëï ¬øCu√°ntas remeras trajo ‚Ä¶ al campamento?', tipo: 'numero', placeholder: 'Ej: 3' },
      { texto: 'üö∂ ¬øCu√°nta distancia (km) caminando hay del predio a Iglesia del Salvador?', tipo: 'numero', placeholder: 'Ej: 2.5' },
      { texto: 'üí∞ ¬øCu√°nta plata tiene en Mercado Pago ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 15000' },
      { texto: 'üõèÔ∏è ¬øCu√°ntas camas tiene el predio?', tipo: 'numero', placeholder: 'Ej: 20' },
      { texto: 'üì± ¬øCu√°ntos posteos en Instagram tiene ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 42' },
      { texto: '‚è∞ ¬øA qu√© hora tiene seteada la alarma ‚Ä¶?', tipo: 'hora', placeholder: '08:30' },

      // --- Digital / Celular (Lo que m√°s se revisa en el momento) ---
      { texto: 'üîã ¬øQu√© porcentaje de bater√≠a tiene el celular de ‚Ä¶ ya mismo?', tipo: 'numero', placeholder: 'Ej: 64' },
      { texto: 'üí¨ ¬øCu√°ntos chats sin leer tiene ‚Ä¶ en WhatsApp?', tipo: 'numero', placeholder: 'Ej: 12' },
      { texto: 'üì¢ ¬øEn cu√°ntos grupos de WhatsApp est√° metido/a ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 28' },
      { texto: 'üö´ ¬øCu√°ntos contactos tiene BLOQUEADOS ‚Ä¶ en WhatsApp?', tipo: 'numero', placeholder: 'Ej: 5' },
      { texto: '‚≠ê ¬øCu√°ntos stickers tiene guardados en "Favoritos" de WhatsApp ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 32' },
      { texto: 'üì∏ ¬øCu√°ntas fotos tiene en total en la galer√≠a ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 2450' },
      { texto: 'ü§≥ ¬øCu√°ntas selfies se sac√≥ ‚Ä¶ en lo que va del d√≠a?', tipo: 'numero', placeholder: 'Ej: 2' },
      { texto: 'üåê ¬øCu√°ntas pesta√±as del navegador tiene abiertas ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 18' },
      { texto: 'üì© ¬øCu√°ntos correos sin leer marca el √≠cono del mail de ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 1500' },
      { texto: 'üë• ¬øA cu√°ntas personas sigue ‚Ä¶ en Instagram?', tipo: 'numero', placeholder: 'Ej: 350' },
      { texto: 'üü¢ ¬øA cu√°ntas personas tiene ‚Ä¶ en "Mejores Amigos" (CF) de Instagram?', tipo: 'numero', placeholder: 'Ej: 45' },
      { texto: 'üìù ¬øCu√°ntas notas tiene creadas en la app de notas del celular ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 15' },
      { texto: '‚è∞ ¬øCu√°ntas alarmas tiene creadas en total (activas o no) ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 8' },
      { texto: 'üìû ¬øCu√°ntos contactos tiene guardados en la agenda ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 640' },

      // --- Log√≠stica / Valija / F√≠sico ---
      { texto: 'üëü ¬øCu√°nto calza (talle de zapatillas) ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 40' },
      { texto: 'üëü ¬øCu√°ntos pares de calzado (zapatillas + ojotas) trajo ‚Ä¶ en total?', tipo: 'numero', placeholder: 'Ej: 3' },
      { texto: 'üß¶ ¬øCu√°ntos pares de medias trajo ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 6' },
      { texto: 'üß• ¬øCu√°ntos buzos o camperas trajo ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 2' },
      { texto: 'üëñ ¬øCu√°ntos pantalones (cortos + largos) trajo ‚Ä¶ en total?', tipo: 'numero', placeholder: 'Ej: 4' },
      { texto: 'üîå ¬øCu√°ntos cables/cargadores trajo ‚Ä¶ en la mochila?', tipo: 'numero', placeholder: 'Ej: 2' },
      { texto: 'üß¥ ¬øDe cu√°nto es el factor del protector solar de ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 50' },
      { texto: 'üíµ ¬øCu√°ntos billetes (f√≠sicos) tiene ‚Ä¶ en la billetera ahora mismo?', tipo: 'numero', placeholder: 'Ej: 5' },
      { texto: 'üí≥ ¬øCu√°ntas tarjetas pl√°sticas (DNI, d√©bito, SUBE, obra social) tiene encima ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 5' },
      { texto: 'üìè ¬øCu√°nto mide (en cm) ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 175' },

      // --- Contexto Cristiano / Personal ---
      { texto: 'üî• ¬øDe cu√°ntos d√≠as es la racha de Biblia (YouVersion) de ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 45' },
      { texto: 'üôè ¬øCu√°ntos a√±os hace que ‚Ä¶ asiste a la iglesia?', tipo: 'numero', placeholder: 'Ej: 4' },
      { texto: 'üèïÔ∏è ¬øA cu√°ntos campamentos asisti√≥ ‚Ä¶ en su vida (aprox)?', tipo: 'numero', placeholder: 'Ej: 6' },
      { texto: 'üìñ ¬øCu√°ntas Biblias f√≠sicas hay en la habitaci√≥n donde duerme ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 4' },
      { texto: '‚õ™ ¬øEn cu√°ntas √°reas/ministerios de la iglesia sirve ‚Ä¶?', tipo: 'numero', placeholder: 'Ej: 1' }
    ];

    const equipos = ['Equipo 1', 'Equipo 2', 'Equipo 3', 'Equipo 4', 'Equipo 5', 'Equipo 6'];
    let preguntaActual = 0;
    let prediccionesPorPregunta = {}; // { preguntaIdx: { equipoIdx: valor } }
    let respuestasDesdeArchivo = null;

    // Cargar respuestas desde archivo
    function aplicarRespuestasCargadas() {
      const ok = document.getElementById('archivo-ok');
      if (respuestasDesdeArchivo) {
        if (ok) { ok.textContent = '‚úÖ Respuestas cargadas correctamente'; ok.classList.remove('oculto'); }
      } else {
        if (ok) ok.classList.add('oculto');
      }
    }
    fetch('respuestas.json')
      .then(r => r.ok ? r.json() : Promise.reject())
      .then(data => {
        respuestasDesdeArchivo = typeof data === 'object' && data !== null ? data : null;
        aplicarRespuestasCargadas();
      })
      .catch(() => { aplicarRespuestasCargadas(); });

    // Referencias DOM
    const textoPregunta = document.getElementById('texto-pregunta');
    const contadorPregunta = document.getElementById('contador-pregunta');
    const btnPreguntaAnterior = document.getElementById('btn-pregunta-anterior');
    const btnPreguntaSiguiente = document.getElementById('btn-pregunta-siguiente');
    const btnRevelarCta = document.getElementById('btn-revelar-cta');
    const resultadoDiv = document.getElementById('resultado');
    const btnFlotanteAyuda = document.getElementById('btn-flotante-ayuda');
    const modalRespuestas = document.getElementById('modal-respuestas');
    const btnCerrarModal = document.getElementById('btn-cerrar-modal');
    const inputArchivoRespuestas = document.getElementById('input-archivo-respuestas');

    function esPreguntaHora() {
      return PREGUNTAS[preguntaActual].tipo === 'hora';
    }

    function lanzarConfetti() {
      if (typeof confetti !== 'undefined') {
        // Usar canvas-confetti para un efecto m√°s dram√°tico
        const duration = 3000;
        const animationEnd = Date.now() + duration;
        const defaults = { 
          startVelocity: 30, 
          spread: 360, 
          ticks: 60, 
          zIndex: 9999,
          colors: ['#FFD700', '#FF7E5F', '#FF6B6B', '#4facfe', '#00f2fe']
        };

        function randomInRange(min, max) {
          return Math.random() * (max - min) + min;
        }

        const interval = setInterval(function() {
          const timeLeft = animationEnd - Date.now();

          if (timeLeft <= 0) {
            return clearInterval(interval);
          }

          const particleCount = 50 * (timeLeft / duration);
          
          confetti(Object.assign({}, defaults, { 
            particleCount, 
            origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } 
          }));
          confetti(Object.assign({}, defaults, { 
            particleCount, 
            origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } 
          }));
        }, 250);
      }
    }
    
    // Funci√≥n de animaci√≥n de conteo
    function animarConteo(elemento, valorFinal, esHora, contexto = {}) {
      const duracion = 1500; // ms
      const pasos = 60;
      const incremento = valorFinal / pasos;
      let valorActual = 0;
      let paso = 0;
      
      const intervalo = setInterval(() => {
        paso++;
        valorActual += incremento;
        
        if (paso >= pasos) {
          clearInterval(intervalo);
          valorActual = valorFinal;
        }
        
        let textoResultado = '‚ú® Respuesta correcta: ';
        
        // Agregar prefijo si existe
        if (contexto.prefix) {
          textoResultado += contexto.prefix + ' ';
        }
        
        // Agregar valor formateado
        textoResultado += formatValor(Math.round(valorActual), esHora);
        
        // Agregar sufijo si existe
        if (contexto.suffix) {
          textoResultado += ' ' + contexto.suffix;
        }
        
        elemento.textContent = textoResultado;
        
        // Efecto de vibraci√≥n en los √∫ltimos pasos
        if (paso >= pasos - 5) {
          elemento.style.transform = `scale(${1 + Math.random() * 0.05})`;
        }
        if (paso >= pasos) {
          elemento.style.transform = 'scale(1)';
        }
      }, duracion / pasos);
    }

    // Detectar contexto de la pregunta para agregar prefijos/sufijos
    function detectarContexto(textoPregunta) {
      const texto = textoPregunta.toLowerCase();
      
      // Detectar prefijos (a la izquierda)
      if (texto.includes('plata') || texto.includes('precio') || texto.includes('mercado pago') || texto.includes('sale') || texto.includes('$')) {
        return { prefix: '$', suffix: null };
      }
      
      // Detectar sufijos (a la derecha)
      if (texto.includes('porcentaje') || texto.includes('bater√≠a') || texto.includes('%')) {
        return { prefix: null, suffix: '%' };
      }
      if (texto.includes(' km') || texto.includes('kil√≥metros') || texto.includes('distancia')) {
        return { prefix: null, suffix: 'km' };
      }
      if (texto.includes(' cm') || texto.includes('cent√≠metros') || texto.includes('mide')) {
        return { prefix: null, suffix: 'cm' };
      }
      if (texto.includes('a√±os') && !texto.includes('cu√°ntos')) {
        return { prefix: null, suffix: 'a√±os' };
      }
      if (texto.includes('d√≠as') && texto.includes('racha')) {
        return { prefix: null, suffix: 'd√≠as' };
      }
      
      return { prefix: null, suffix: null };
    }
    
    // Extraer emoji del inicio del texto
    function extraerEmoji(texto) {
      const emojiRegex = /^(\p{Emoji_Presentation}|\p{Emoji}\uFE0F)\s*/u;
      const match = texto.match(emojiRegex);
      if (match) {
        return {
          emoji: match[0].trim(),
          textoSinEmoji: texto.slice(match[0].length).trim()
        };
      }
      return { emoji: '', textoSinEmoji: texto };
    }
    
    // Ajustar tama√±o de fuente seg√∫n longitud del texto
    function ajustarTipografia(elemento, texto) {
      // Remover clases anteriores
      elemento.classList.remove('text-corto', 'text-medio', 'text-largo', 'text-muy-largo');
      
      const longitud = texto.length;
      
      if (longitud < 30) {
        elemento.classList.add('text-corto');
      } else if (longitud < 60) {
        elemento.classList.add('text-medio');
      } else if (longitud < 90) {
        elemento.classList.add('text-largo');
      } else {
        elemento.classList.add('text-muy-largo');
      }
    }
    
    // Formatear n√∫mero con separador de miles
    function formatearNumeroConSeparador(numero) {
      return numero.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }
    
    function actualizarUI() {
      const p = PREGUNTAS[preguntaActual];
      
      // Animar cambio de pregunta
      textoPregunta.style.animation = 'none';
      setTimeout(() => {
        textoPregunta.style.animation = 'bounce-in 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
      }, 10);
      
      // Extraer emoji y texto
      const { emoji, textoSinEmoji } = extraerEmoji(p.texto);
      
      // Actualizar t√≠tulo con emoji destacado
      if (emoji) {
        textoPregunta.innerHTML = `<span class="emoji-icon">${emoji}</span>${textoSinEmoji}`;
      } else {
        textoPregunta.textContent = p.texto;
      }
      
      // Ajustar tipograf√≠a seg√∫n longitud
      ajustarTipografia(textoPregunta, textoSinEmoji || p.texto);
      
      contadorPregunta.textContent = `üèÑ Pregunta ${preguntaActual + 1}`;
      
      // Detectar contexto para prefijos/sufijos
      const contexto = detectarContexto(p.texto);
      
      // Actualizar inputs seg√∫n el tipo de pregunta
      const inputWrappers = document.querySelectorAll('.input-wrapper');
      inputWrappers.forEach((wrapper, idx) => {
        // Limpiar wrapper
        wrapper.innerHTML = '';
        
        // Crear input seg√∫n tipo
        const input = document.createElement('input');
        input.className = 'input-pred';
        input.dataset.equipo = idx;
        input.placeholder = p.placeholder;
        
        if (p.tipo === 'hora') {
          input.type = 'time';
          input.step = '60'; // Intervalos de 1 minuto
        } else {
          input.type = 'text';
          input.inputMode = 'numeric';
          
          // Agregar clase si tiene prefijo/sufijo
          if (contexto.prefix) input.classList.add('has-prefix');
          if (contexto.suffix) input.classList.add('has-suffix');
        }
        
        // Agregar prefijo si existe
        if (contexto.prefix) {
          const prefix = document.createElement('span');
          prefix.className = 'input-prefix';
          prefix.textContent = contexto.prefix;
          wrapper.appendChild(prefix);
        }
        
        // Agregar input
        wrapper.appendChild(input);
        
        // Agregar sufijo si existe
        if (contexto.suffix) {
          const suffix = document.createElement('span');
          suffix.className = 'input-suffix';
          suffix.textContent = contexto.suffix;
          wrapper.appendChild(suffix);
        }
        
        // Agregar listener para estado "listo" y formateo
        input.addEventListener('input', (e) => {
          const item = input.closest('.input-fila-item');
          
          // Actualizar estado "listo"
          if (input.value.trim()) {
            item.classList.add('listo');
          } else {
            item.classList.remove('listo');
          }
          
          // Formateo autom√°tico para n√∫meros (solo si no es hora)
          if (p.tipo !== 'hora' && input.value) {
            // Guardar posici√≥n del cursor
            const cursorPos = input.selectionStart;
            const valorAnterior = input.value;
            
            // Remover caracteres no num√©ricos excepto punto y coma
            let valorLimpio = input.value.replace(/[^\d.,]/g, '');
            
            // Si tiene punto o coma, mantenerlo como decimal
            if (valorLimpio.includes(',') || valorLimpio.includes('.')) {
              // Convertir coma a punto para consistencia
              valorLimpio = valorLimpio.replace(',', '.');
              
              // Asegurar solo un punto decimal
              const partes = valorLimpio.split('.');
              if (partes.length > 2) {
                valorLimpio = partes[0] + '.' + partes.slice(1).join('');
              }
              
              // Formatear la parte entera con separadores
              if (partes[0]) {
                const parteEntera = partes[0].replace(/\B(?=(\d{3})+(?!\d))/g, ".");
                const parteDecimal = partes[1] !== undefined ? partes[1] : '';
                valorLimpio = parteDecimal ? `${parteEntera},${parteDecimal}` : parteEntera;
              }
            } else if (valorLimpio) {
              // Solo n√∫meros enteros, agregar separadores de miles
              valorLimpio = valorLimpio.replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            }
            
            // Solo actualizar si cambi√≥
            if (valorLimpio !== valorAnterior) {
              input.value = valorLimpio;
              
              // Restaurar posici√≥n del cursor (aproximada)
              const diferencia = valorLimpio.length - valorAnterior.length;
              input.setSelectionRange(cursorPos + diferencia, cursorPos + diferencia);
            }
          }
        });
        
        // Validar que solo se ingresen n√∫meros (excepto en hora)
        if (p.tipo !== 'hora') {
          input.addEventListener('keypress', (e) => {
            // Permitir: n√∫meros, punto, coma, backspace, delete, tab
            const char = e.key;
            if (!/[\d.,]/.test(char) && 
                !['Backspace', 'Delete', 'Tab', 'ArrowLeft', 'ArrowRight'].includes(e.key)) {
              e.preventDefault();
            }
          });
        }
      });

      // Actualizar botones de navegaci√≥n
      btnPreguntaAnterior.disabled = preguntaActual === 0;
      btnPreguntaSiguiente.disabled = preguntaActual === PREGUNTAS.length - 1;

      // Ocultar resultado al cambiar de pregunta
      resultadoDiv.classList.add('oculto');

      // Limpiar estados de las tarjetas
      document.querySelectorAll('.input-fila-item').forEach(item => {
        item.classList.remove('ganador', 'perdedor', 'listo');
      });

      // Cargar predicciones si ya existen para esta pregunta
      cargarPrediccionesActuales();
    }

    function cargarPrediccionesActuales() {
      const predicciones = prediccionesPorPregunta[preguntaActual] || {};
      const inputsPred = document.querySelectorAll('.input-pred');
      inputsPred.forEach(inp => {
        const equipoIdx = parseInt(inp.dataset.equipo, 10);
        const valor = predicciones[equipoIdx];
        const item = inp.closest('.input-fila-item');
        if (valor !== undefined) {
          inp.value = formatValor(valor, esPreguntaHora());
          item.classList.add('listo');
        } else {
          inp.value = '';
          item.classList.remove('listo');
        }
      });
    }

    // Modal de respuestas
    if (btnFlotanteAyuda) {
      btnFlotanteAyuda.addEventListener('click', () => {
        modalRespuestas.classList.remove('oculto');
      });
    }
    
    if (btnCerrarModal) {
      btnCerrarModal.addEventListener('click', () => {
        modalRespuestas.classList.add('oculto');
      });
    }

    if (modalRespuestas) {
      modalRespuestas.addEventListener('click', (e) => {
        if (e.target === modalRespuestas) {
          modalRespuestas.classList.add('oculto');
        }
      });
    }

    if (inputArchivoRespuestas) {
      inputArchivoRespuestas.addEventListener('change', () => {
        const file = inputArchivoRespuestas.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const data = JSON.parse(e.target.result);
            respuestasDesdeArchivo = typeof data === 'object' && data !== null ? data : null;
          } catch (err) {
            respuestasDesdeArchivo = null;
          }
          aplicarRespuestasCargadas();
        };
        reader.readAsText(file);
      });
    }

    // Navegaci√≥n de preguntas
    if (btnPreguntaAnterior) {
      btnPreguntaAnterior.addEventListener('click', () => {
        if (preguntaActual > 0) {
          guardarPrediccionesActuales();
          preguntaActual--;
          actualizarUI();
        }
      });
    }

    if (btnPreguntaSiguiente) {
      btnPreguntaSiguiente.addEventListener('click', () => {
        if (preguntaActual < PREGUNTAS.length - 1) {
          guardarPrediccionesActuales();
          preguntaActual++;
          actualizarUI();
        }
      });
    }

    function guardarPrediccionesActuales() {
      const inputsPred = document.querySelectorAll('.input-pred');
      const predicciones = {};
      inputsPred.forEach(inp => {
        const equipoIdx = parseInt(inp.dataset.equipo, 10);
        const val = parseValorInput(inp.value, esPreguntaHora());
        if (val !== null) {
          predicciones[equipoIdx] = val;
        }
      });
      if (Object.keys(predicciones).length > 0) {
        prediccionesPorPregunta[preguntaActual] = predicciones;
      }
    }

    function parseValorInput(texto, esHora) {
      const t = String(texto || '').trim();
      if (!t) return null;
      
      if (esHora) {
        const part = t.split(':');
        const h = parseInt(part[0], 10);
        const m = part.length > 1 ? parseInt(part[1], 10) : 0;
        if (isNaN(h)) return null;
        return h * 60 + (isNaN(m) ? 0 : m);
      }
      
      // Remover separadores de miles (puntos) y convertir coma decimal a punto
      const valorLimpio = t.replace(/\./g, '').replace(',', '.');
      const n = parseFloat(valorLimpio);
      return isNaN(n) ? null : n;
    }

    function formatValor(valor, esHora) {
      if (esHora) {
        const h = Math.floor(valor / 60);
        const m = Math.round(valor % 60);
        return (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m;
      }
      
      // Formatear n√∫meros con separador de miles
      if (Number.isInteger(valor)) {
        return valor.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
      } else {
        // Para decimales, formatear la parte entera
        const partes = valor.toString().split('.');
        partes[0] = partes[0].replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        return partes.join(',');
      }
    }

    function escapeHtml(s) {
      const div = document.createElement('div');
      div.textContent = s;
      return div.innerHTML;
    }

    function parseRespuestaCorrecta(preguntaIdx, esHora) {
      const desdeArchivo = respuestasDesdeArchivo && respuestasDesdeArchivo[String(preguntaIdx)] != null
        ? String(respuestasDesdeArchivo[String(preguntaIdx)]).trim()
        : '';
      if (!desdeArchivo) return null;
      if (esHora) {
        const part = desdeArchivo.replace(',', '.').split(':');
        const h = parseInt(part[0], 10);
        const m = part.length > 1 ? parseInt(part[1], 10) : 0;
        if (isNaN(h)) return null;
        return h * 60 + (isNaN(m) ? 0 : m);
      }
      const n = parseFloat(desdeArchivo.replace(',', '.'));
      return isNaN(n) ? null : n;
    }

    function revelar() {
      // Guardar predicciones actuales
      guardarPrediccionesActuales();

      // Verificar que haya predicciones para la pregunta actual
      const predicciones = prediccionesPorPregunta[preguntaActual];
      if (!predicciones || Object.keys(predicciones).length === 0) {
        alert('Ingres√° las predicciones de los equipos antes de revelar.');
        return;
      }

      // Verificar que haya respuesta correcta
      const pregunta = PREGUNTAS[preguntaActual];
      const correcta = parseRespuestaCorrecta(preguntaActual, pregunta.tipo === 'hora');
      if (correcta === null) {
        alert('No hay respuesta correcta para esta pregunta en respuestas.json. Carg√° el archivo desde el bot√≥n "üèùÔ∏è".');
        return;
      }

      // Calcular distancias y encontrar ganadores
      const distancias = [];
      const equiposIdx = [];
      for (let i = 0; i < 6; i++) {
        if (predicciones[i] !== undefined) {
          distancias.push(Math.abs(predicciones[i] - correcta));
          equiposIdx.push(i);
        }
      }

      if (distancias.length === 0) {
        alert('No hay predicciones para revelar.');
        return;
      }

      const minDist = Math.min(...distancias);
      const ganadoresIdx = equiposIdx.filter((idx, i) => distancias[i] === minDist);

      // Aplicar estados visuales a las tarjetas
      const items = document.querySelectorAll('.input-fila-item');
      items.forEach((item, idx) => {
        item.classList.remove('ganador', 'perdedor', 'listo');
        if (ganadoresIdx.includes(idx)) {
          setTimeout(() => item.classList.add('ganador'), 300);
        } else if (predicciones[idx] !== undefined) {
          item.classList.add('perdedor');
        }
      });

      // Mostrar resultado con animaci√≥n de conteo
      const nombreGanador = ganadoresIdx.length > 1 
        ? ganadoresIdx.map(i => equipos[i]).join(' y ') 
        : equipos[ganadoresIdx[0]];
      
      // Detectar contexto para el resultado
      const contextoResultado = detectarContexto(pregunta.texto);
      
      resultadoDiv.innerHTML = '<div class="respuesta-correcta">‚ú® Respuesta correcta: 0</div>' +
                               '<div class="ganador-texto">' + (ganadoresIdx.length > 1 ? 'üéâ ¬°Empate! ' : 'üèÜ Ganador: ') + escapeHtml(nombreGanador) + '</div>';
      resultadoDiv.classList.remove('oculto');
      
      // Animar el conteo
      const respuestaEl = resultadoDiv.querySelector('.respuesta-correcta');
      setTimeout(() => {
        animarConteo(respuestaEl, correcta, pregunta.tipo === 'hora', contextoResultado);
      }, 400);

      // Lanzar confetti con delay
      setTimeout(() => lanzarConfetti(), 1000);
      setTimeout(() => mostrarToastRevelado(nombreGanador, ganadoresIdx.length > 1), 1500);
    }

    function mostrarToastRevelado(nombreGanador, esEmpate) {
      const toast = document.getElementById('toast-playero');
      if (!toast) return;
      const mensaje = esEmpate ? 'üéâ ¬°Empate! ' + nombreGanador : 'üèÜ ¬°Ganador: ' + nombreGanador + '! üåä';
      toast.innerHTML = '<span class="toast-icon">üèñÔ∏è</span>' + mensaje;
      toast.classList.remove('oculto', 'toast-sale');
      toast.setAttribute('aria-label', esEmpate ? 'Empate' : 'Ganador: ' + nombreGanador);
      requestAnimationFrame(() => toast.classList.add('toast-visible'));
      clearTimeout(toast._timeout);
      toast._timeout = setTimeout(() => {
        toast.classList.add('toast-sale');
        setTimeout(() => {
          toast.classList.remove('toast-visible');
          toast.classList.add('oculto');
        }, 400);
      }, 3200);
    }

    // Bot√≥n revelar
    if (btnRevelarCta) btnRevelarCta.addEventListener('click', revelar);

    // Atajo de teclado para revelar (Espacio)
    document.addEventListener('keydown', (e) => {
      if (e.code === 'Space' && e.target.tagName !== 'INPUT' && e.target.tagName !== 'SELECT' && e.target.tagName !== 'TEXTAREA') {
        e.preventDefault();
        revelar();
      }
    });

    // Inicializaci√≥n
    actualizarUI();

    // Animaciones de entrada dram√°ticas
    if (typeof anime !== 'undefined') {
      anime({
        targets: '.nav-superior',
        opacity: [0, 1],
        translateY: [-20, 0],
        duration: 500,
        easing: 'easeOutCubic'
      });
      anime({
        targets: '.area-pregunta-grande',
        opacity: [0, 1],
        scale: [0.8, 1],
        duration: 600,
        delay: 100,
        easing: 'easeOutBack'
      });
      anime({
        targets: '.area-predicciones',
        opacity: [0, 1],
        translateY: [30, 0],
        duration: 500,
        delay: 200,
        easing: 'easeOutCubic'
      });
      anime({
        targets: '.input-fila-item',
        opacity: [0, 1],
        scale: [0.9, 1],
        duration: 400,
        delay: anime.stagger(80, {start: 300}),
        easing: 'easeOutBack'
      });
      anime({
        targets: '.btn-flotante-revelar',
        opacity: [0, 1],
        scale: [0.5, 1],
        duration: 600,
        delay: 500,
        easing: 'easeOutElastic(1, .6)'
      });
      anime({
        targets: '.btn-flotante-ayuda',
        opacity: [0, 1],
        rotate: [180, 0],
        scale: [0, 1],
        duration: 500,
        delay: 600,
        easing: 'easeOutBack'
      });
    }
  </script>
</body>
</html>
